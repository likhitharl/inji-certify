TokenExchange:
  InjiCertify_TokenExchange_preauthcode_Valid_Smoke_sid:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_01
    description: Exchange pre-authorized code for access token
    role: noauth
    restMethod: post
    checkErrorsOnlyInResponse: true
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchangeResult
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "$ID:GetCredentialOffer_preauthcode_Valid_Smoke_sid_pre-authorized_code$",
      "tx_code": "1234"
    }'
    output: '{
    }'

  InjiCertify_TokenExchange_preauthcode_WithTxCode_Smoke_sid:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_02
    description: Exchange pre-authorized code with alphanumeric tx_code
    role: noauth
    restMethod: post
    checkErrorsOnlyInResponse: true
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchangeResult
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "$ID:GetCredentialOffer_preauthcode_Valid_Smoke_sid_pre-authorized_code$",
      "tx_code": "abc12345"
    }'
    output: '{
    }'

  InjiCertify_TokenExchange_preauthcode_UnsupportedGrantType_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_04
    description: Token exchange with unsupported grant type
    role: noauth
    restMethod: post
    checkErrorsOnlyInResponse: true
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "authorization_code",
      "pre-authorized_code": "$ID:GetCredentialOffer_preauthcode_Valid_Smoke_sid_pre-authorized_code$"
    }'
    output: '{
      "error": "unsupported_grant_type"
    }'

  InjiCertify_TokenExchange_preauthcode_InvalidCode_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_05
    description: Token exchange with invalid pre-authorized code
    role: noauth
    restMethod: post
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "invalid_pre_auth_code_12345"
    }'
    output: '{
      "error": "invalid_grant"
    }'

  InjiCertify_TokenExchange_preauthcode_MissingTxCode_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_06
    description: Token exchange without tx_code when it is required
    role: noauth
    restMethod: post
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "$ID:InjiCertify_GeneratePreAuthCode_WithTxCode_Smoke_sid_preAuthCode$"
    }'
    output: '{
      "error": "tx_code_required"
    }'

  InjiCertify_TokenExchange_preauthcode_randomTxCode_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_07
    description: Token exchange with incorrect tx_code value
    role: noauth
    restMethod: post
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "$ID:InjiCertify_GeneratePreAuthCode_WithTxCode_Smoke_sid_preAuthCode$",
      "tx_code": "wrongcode"
    }'
    output: '{
      "error": "tx_code_mismatch"
    }'

  InjiCertify_TokenExchange_preauthcode_CodeExpired_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_09
    description: Token exchange with expired pre-authorized code
    role: noauth
    restMethod: post
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "urn:ietf:params:oauth:grant-type:pre-authorized_code",
      "pre-authorized_code": "$ID:InjiCertify_GeneratePreAuthCode_ShortExpiry_Smoke_sid_preAuthCode$"
    }'
    output: '{
      "error": "pre_auth_code_expired"
    }'

  InjiCertify_TokenExchange_preauthcode_withoutGrantType_Neg:
    endPoint: $INJICERTIFYBASEURL$/oauth/token
    uniqueIdentifier: TC_preauth_TokenExchange_Neg_04
    description: Token exchange with unsupported grant type
    role: noauth
    restMethod: post
    checkErrorsOnlyInResponse: true
    inputTemplate: injicertify/PreAuthCodeFlow/TokenExchange/TokenExchange
    outputTemplate: injicertify/error2
    input: '{
      "grant_type": "$REMOVE$",
      "pre-authorized_code": "some_code"
    }'
    output: '{
      "error": "unsupported_grant_type"
    }'
